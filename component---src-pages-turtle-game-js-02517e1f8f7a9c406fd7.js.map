{"version":3,"sources":["webpack:///./src/components/turtleGame/turtle.js","webpack:///./src/components/turtleGame/mine.js","webpack:///./src/components/turtleGame/cell.js","webpack:///./src/components/turtleGame/controls.js","webpack:///./src/components/turtleGame/utils.js","webpack:///./src/components/turtleGame/grid.js","webpack:///./src/pages/turtle-game.js","webpack:///./node_modules/core-js/modules/es6.array.fill.js","webpack:///./node_modules/core-js/modules/_array-fill.js","webpack:///./src/images/turtle.png","webpack:///./src/images/mine.png"],"names":["connect","state","direction","turtleGame","props","css","transform","Object","core_browser_esm","style","src","Img","Mines","Cell","_Component","call","this","clickCell","console","log","getComp","type","comp","turtleGame_turtle","class","turtleGame_mine","render","_this","el","onClick","className","Component","Control","_useState","useState","count","setCount","callback","allMask","document","querySelectorAll","forEach","e","i","setTimeout","classList","add","remove","length","showHide","disabled","toMap","arr","map","x","y","randomRange","min","max","Math","ceil","floor","random","Grid","_React$Component","turtle","mines","minesMap","_direction","cellVisited","col","Array","size","h","fill","row","w","commands","transformPos","_ref","getType","posStr","turtlePos","indexOf","componentDidUpdate","updateTurtle","evt","dir","newPos","setState","concat","charAt","_rotate","_ref2","_this2","isOut","hitMine","react","key","ind","cell","controls","join","React","propTypes","PropTypes","object","isRequired","array","dispatch","rotateTurtle","gridWidth","gridHeight","nbrMine","minesMax","sizeGrid","IndexPage","layout","seo","title","keywords","grid","$export","__webpack_require__","P","toObject","toAbsoluteIndex","toLength","module","exports","value","O","aLen","arguments","index","undefined","end","endPos","p"],"mappings":"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","file":"component---src-pages-turtle-game-js-02517e1f8f7a9c406fd7.js","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport Img from '../../images/turtle.png';\n\nconst Turtle = props => {\n  const css = {\n    transform: `rotate(${props.direction}deg)`,\n  };\n  return <img style={css} src={Img} />;\n};\n\nexport default connect(state => ({ direction: state.turtleGame.direction }))(Turtle);\n","import React from 'react'\nimport Img from '../../images/mine.png'\nconst Mines = props => {\n  return (\n    <img src={Img}/>\n  )\n}\n\nexport default Mines","import React, { Component } from 'react';\nimport Turtle from './turtle';\nimport Mine from './mine';\nclass Cell extends Component {\n  constructor(props) {\n    super(props);\n  }\n  clickCell() {\n    console.log(this.props);\n  }\n\n  getComp(type) {\n    if (type === 'turtle') {\n      const comp =  <Turtle />;\n      return {\n        comp,\n        class: 'turtle'\n      }      \n    } else if (type === 'collision') {\n      const comp =  <Mine />\n      return {\n        comp,\n        class: 'mine visited'\n      }\n    } else if (type === 'mine') {\n      const comp =  <Mine />\n      return {\n        comp,\n        class: 'mine'\n      }\n    } else if (type === 'visited') {\n      const comp = (<div></div>)\n      return {\n        comp,\n        class: 'visited'\n      }\n    } else {\n      const comp = (<div></div>)\n      return {\n        comp,\n        class: 'empty'\n      }\n    }\n  }\n\n  render() {\n    const el = this.getComp(this.props.type);\n    return (\n      <div onClick={() => this.clickCell()} className='cell'>\n        <div className={`mask ${el.class}`}></div>\n         {el.comp}\n      </div>\n    );\n  }\n}\n\nexport default Cell;\n","import React, {useState} from 'react'\n\nconst Control = props => {\n  const [count, setCount] = useState(3)\n\n  const move = () => {\n    props.callback('move')\n  }\n  const rotate = () => {\n    props.callback('rotate')\n  }\n  const showHide = () => {\n    setCount(count - 1)\n    if (count > 0) {\n      const allMask = document.querySelectorAll('.cell .mask')\n      allMask.forEach( (e, i) => {\n        setTimeout( () => e.classList.add('display'), 50 * i)   \n        setTimeout(() => {\n          allMask.forEach( e => e.classList.remove('display') )\n        }, allMask.length + 50 * i)     \n      })     \n    }\n  }\n  \n  return (\n    <div>\n      <button onClick={() => move()}>Move</button>\n      <button onClick={() => rotate()}>Rotate</button>      \n      <button onClick={() => showHide() } disabled={ count > 0 ? false : true }>show/hide {count}</button>\n    </div>\n  )\n}\nexport default Control","export const toMap = arr => {\n  const map = {};\n  for (var i in arr) {\n    const str = `${arr[i].x}_${arr[i].y}`;\n    map[str] = 1;\n  }\n  return map;\n};\nexport const calculatePos = (turtle, dir) => {\n  const { x, y } = turtle;\n  let newPos;\n  if (dir === 0) {\n    newPos = { x, y: y - 1 };\n  } else if (dir === 90) {\n    newPos = { x: x + 1, y };\n  } else if (dir === 180) {\n    newPos = { x, y: y + 1 };\n  } else if (dir === 270) {\n    newPos = { x: x - 1, y };\n  }\n  return newPos;\n};\nexport const outOfBound = ({ x, y }, { h, w }) => {\n  const wValid = x > 0 && x <= w;\n  const hValid = y > 0 && y <= h;\n  return !wValid || !hValid;\n};\n\n\nexport const collision = (posStr, map) => {\n  return !!map[posStr]\n}\n\nexport const randomRange = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","import React, {Fragment} from 'react';\nimport Cell from './cell';\nimport Control from './controls';\nimport PropTypes from 'prop-types';\nimport { rotate as rotateTurtle } from '../../state/turtleGame';\nimport { connect } from 'react-redux';\nimport { toMap, outOfBound, calculatePos, collision } from './utils';\n\nclass Grid extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      turtle: this.props.turtle,\n      mines: this.props.mines,\n      minesMap: toMap(this.props.mines),\n      direction: this.props._direction,\n      cellVisited: [],\n      col: new Array(this.props.size.h).fill(null),\n      row: new Array(this.props.size.w).fill(null),\n      commands: []\n    };\n  }\n  transformPos({ x, y }) {\n    return `${x}_${y}`;\n  }\n  getType(x, y) {\n    const posStr = this.transformPos({ x, y });\n    const turtlePos = this.transformPos(this.state.turtle);\n    if(posStr === turtlePos && this.state.minesMap[posStr]) {\n      return 'collision'\n    } else if (this.state.minesMap[posStr]) {\n      return 'mine';\n    }  else if (posStr === turtlePos) {\n      return 'turtle';\n    } else if (this.state.cellVisited.indexOf(posStr) > -1) {\n      return 'visited'\n    } else {\n      return 'cell';\n    }\n  }\n  componentDidUpdate() {  }\n  updateTurtle(evt) {\n    if (evt === 'move') {\n      this.setState({\n        turtle: calculatePos(this.state.turtle, this.props._direction),\n        cellVisited: [...this.state.cellVisited, this.transformPos(this.state.turtle) ],\n        commands: [...this.state.commands, evt.charAt(0)]\n      });\n    } else {\n      this.setState({\n        commands: [...this.state.commands, evt.charAt(0)]\n      })\n      this.props._rotate();\n    }\n  }\n  \n\n  render() {\n    const isOut = outOfBound(this.state.turtle, this.props.size);\n    const hitMine = collision(this.transformPos(this.state.turtle), this.state.minesMap)\n    return (\n      <Fragment>\n        {isOut && <div>OUTSIDE</div>}\n        {hitMine && <div>COLLISION</div>}\n        \n        <div className=\"grid\">\n          {this.state.col.map((e, i) => {\n            return (\n              <div key={i} className=\"row-container\">\n                {this.state.row.map((el, ind) => {\n                  const type = this.getType(ind + 1, i + 1);\n                  return <Cell type={type} key={ind} x={ind + 1} y={i + 1} />;\n                })}\n              </div>\n            );\n          })}\n        </div>\n        <Control callback={e => this.updateTurtle(e)} />\n        {this.state.commands.length > 0 && \n          <Fragment>\n            <h3>Commands</h3>\n            <code>{this.state.commands.map(e => `'${e}'`).join(', ')}</code>\n          </Fragment>         \n        }\n      </Fragment>\n    );\n  }\n}\nGrid.propTypes = {\n  size: PropTypes.object.isRequired,\n  turtle: PropTypes.object.isRequired,\n  mines: PropTypes.array.isRequired,\n};\nexport default connect(\n  state => ({ _direction: state.turtleGame.direction }),\n  dispatch => ({ _rotate: () => dispatch(rotateTurtle()) }),\n)(Grid);\n","import React from 'react';\nimport Layout from '../components/layout';\nimport SEO from '../components/seo';\nimport Grid from '../components/turtleGame/grid';\nimport { randomRange } from '../components/turtleGame/utils'\nconst min = 5\nconst max = 10\nconst gridWidth = randomRange(min, max)\nconst gridHeight = randomRange(min, max)\nconst minesMin = (min * min) / 2\nconst minesMax = (max * max) * 0.75\nconst nbrMine = randomRange(2, minesMax/2)\nconst mines = new Array(nbrMine).fill(null).map( e => {\n  return  { \n    x: randomRange(2, max), \n    y: randomRange(2, max) \n  } \n})\nconsole.log(mines)\n\nconst sizeGrid = { w: gridWidth, h: gridHeight }\nconst IndexPage = () => (\n  <Layout>\n    <SEO title=\"Game\" keywords={[`gatsby`, `game`, `react`]} />\n    <h1>Deminor Game</h1>\n    <p>Find the exit and take care to the mines...</p>\n    <Grid className={`grid-component`} size={sizeGrid} turtle={{ x: 1, y: 1 }} mines={mines} />\n  </Layout>\n);\n\nexport default IndexPage;\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { fill: require('./_array-fill') });\n\nrequire('./_add-to-unscopables')('fill');\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","module.exports = __webpack_public_path__ + \"static/turtle-829e6ff7f2a7a884849e36746513042e.png\";","module.exports = __webpack_public_path__ + \"static/mine-520178a9e230470dffce265d175ba018.png\";"],"sourceRoot":""}